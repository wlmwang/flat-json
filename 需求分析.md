# 需求背景
1. 面对B端复杂多变的需求，后端需要能够快速响应
> 即：需求增、减字段时，后端应能够透明、或最小化配置

# 需求分析
1. 提供一个附带了能够保存JSON数据字段的数据集
   * 将前端提交的表单数据（键值对），除了能够直接映射到该数据集常规字段外，剩余的部分全部自动编码为JSON结构数据映射到该JSON字段中，一并存储
   * 当前端查询该数据集的记录时，JSON字段能够自动解码，平铺成一级键值对（移除JSON字段的键），与提交时的表单数据保持一致
   * 总结：该JSON数据字段对外接口是透明的
2. 保存在JSON字段中的数据，参与自定义搜索；并可排序（排序字段需数字类型）
   * 字符串类型字段：精确匹配、模糊匹配
   * 数字类型字段：精确匹配、范围匹配
   * 数组类型字段：包含匹配（元素为字符串：精确匹配、模糊匹配；元素为数字时：精确匹配）
   * 对象类型字段：使用el表达式？？？
   * 键是否存在：搜索？？？
3. 由于JSON字段较为松散，希望能够在保存数据集时提供约束功能？？？
   * 校验指定字段是否必须
   * 校验指定字段数据类型：number、string、array、object
   * 可快速启停以上所有约束功能
4. JSON字段中键值能够提供别名功能？？？

# 技术方案
1. 持久层
   * 使用数据库的JSON字段类型、varchar+json函数
   * 至少支持Mysql、Postgres，完成其功能测试
2. 前端 - 拥有所有字段的最终解释权
   * 支持form body、json body提交数据集
   * 对form+json column表单域提交，不特殊场景不支持，但后端会提供快速开发能力。其实没必要！！！
3. Java后端
   * 将支持JSON字段的实体类，使用注解：@JsonPackEntity，@TableName(autoResultMap = true)
   * 同时，将该实体类中实际的映射为JSON字段的类属性，使用注解：@JsonPackField，@TableField(typeHandler = JacksonTypeHandler.class)
     * 无必须要求外，请将该类属性定义为Map<String, Object>
4. 后端侧详细设计
   * 使用自定义SpringMVC HttpMessageConverter，实现form数据到java bean转换
   * 使用自定义@JsonPackEntity、@JsonPackField，开启附带JSON字段的实体
   * 使用自定义Mybatis Interceptor，实现不同数据库的字段搜索功能

# 未来路线
1. 支持JSON字段约束
2. 支持JSON字段别名
3. 支持JSON映射为抽象字段，优化搜索
4. 支持更多数据库

